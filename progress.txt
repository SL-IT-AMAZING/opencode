# Progress Log

## Learnings
(Patterns discovered during implementation)

---

## Iteration 1 - US-001: Add Preview Tab Helpers to File Context
- Implemented three preview tab helper functions in `packages/app/src/context/file.tsx`
- Files changed: `packages/app/src/context/file.tsx`
- Learnings for future iterations:
  - Follow existing patterns: `tab()` and `pathFromTab()` show the encoding/decoding pattern
  - Functions go inside the `init()` function and are added to the return object
  - Preview tab format: `preview://url:<url>` for http/https URLs, `preview://file:<path>` for files
  - Use `normalize(input)` for file paths to ensure consistent paths
---

## Iteration 2 - US-002: Update Tab Filtering for Preview Tabs
- Updated `allTabs` filter to include `preview://` tabs alongside `session-` and `file://` tabs
- Added `activePreviewTab` memo that uses `file.previewFromTab()` to parse active preview tabs
- Files changed: `packages/app/src/pages/session.tsx`
- Learnings for future iterations:
  - `useFile()` context provides preview helpers: `previewFromTab()`, `previewTab()`, `isPreviewTab()`
  - Tab filtering pattern: `tab.startsWith("prefix")` used to distinguish tab types
  - `createMemo()` pattern for computed values in SolidJS
  - `tabs().active()` returns the currently active tab string
  - Run typecheck with `bun run typecheck` from the opencode directory
---

## Iteration 3 - US-003: Fix Content Gating with Switch
- Replaced nested Show blocks with a single Switch/Match structure for content gating
- Created placeholder PreviewPane component in `packages/app/src/components/preview/preview-pane.tsx`
- Files changed:
  - `packages/app/src/pages/session.tsx` (content gating + import)
  - `packages/app/src/components/preview/preview-pane.tsx` (new placeholder)
- Learnings for future iterations:
  - SolidJS Switch/Match is already imported in session.tsx - no additional imports needed
  - Content area uses Switch/Match for mutually exclusive content rendering (preview, file viewer, session)
  - Match components can use callback children pattern: `{(value) => <Component prop={value()} />}`
  - PreviewPane receives `preview: { type: "url" | "file", value: string }` prop
  - Placeholder components help maintain typecheck while implementing in order
---
